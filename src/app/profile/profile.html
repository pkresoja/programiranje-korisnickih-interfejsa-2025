<div class="row">
    <div class="col-12 col-md-8">
        <form [formGroup]="profileForm" (ngSubmit)="onProfileSubmit()">
            <div class="card mb-3">
                <div class="card-header">
                    <!-- <img [src]="`https://ui-avatars.com/api/?name=${currentUser()!.firstName}%20${currentUser()!.lastName}`"> -->
                    <h5>User Profile</h5>
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        <label for="name" class="form-label">First Name</label>
                        <input type="text" class="form-control" id="name" formControlName="firstName">
                    </div>
                    <div class="mb-3">
                        <label for="surname" class="form-label">Last Name</label>
                        <input type="text" class="form-control" id="surname" formControlName="lastName">
                    </div>
                    <div class="mb-3">
                        <label for="phone" class="form-label">Phone Number</label>
                        <input type="tel" class="form-control" id="phone" formControlName="phone">
                    </div>
                    <div class="mb-3">
                        <label for="destination" class="form-label">Choose Destination</label>
                        <select class="form-select" id="destination" formControlName="destination">
                            @for (d of destinations(); track $index) {
                            <option [value]="d">{{d}}</option>
                            }
                        </select>
                    </div>
                </div>
                <div class="card-footer">
                    <button class="btn btn-sm btn-primary">
                        <i class="fa-solid fa-floppy-disk"></i> Save Changes
                    </button>
                </div>
            </div>
        </form>
    </div>
    <div class="col-12 col-md-4">
        <form [formGroup]="passwordForm" (ngSubmit)="onPasswordSubmit()">
            <div class="card mb-3">
                <div class="card-header">
                    <h5>Reset Password</h5>
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        <label for="current" class="form-label">Current Password</label>
                        <input type="password" class="form-control" id="current" formControlName="current">
                    </div>
                    <div class="mb-3">
                        <label for="new" class="form-label">New Password</label>
                        <input type="password" class="form-control" id="new" formControlName="new">
                    </div>
                    <div class="mb-3">
                        <label for="repeat" class="form-label">Repeat Password</label>
                        <input type="password" class="form-control" id="repeat" formControlName="repeat">
                    </div>
                </div>
                <div class="card-footer">
                    <button class="btn btn-sm btn-secondary">
                        <i class="fa-solid fa-floppy-disk"></i> Change Password
                    </button>
                </div>
            </div>
        </form>
    </div>
</div>

<div class="card">
    <div class="card-header">
        <h5>Reservations</h5>
    </div>
    <div class="card-body">
        @if(currentUser()?.data!.length > 0) {
        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th scope="col">Flight Number</th>
                    <th scope="col">Destination</th>
                    <th scope="col" class="hidden-3">Deparuture At</th>
                    <th scope="col" class="hidden-4">Airline</th>
                    <th scope="col" class="hidden-2">Suite</th>
                    <th scope="col">Status</th>
                    <th scope="col" class="hidden-1">Updated At</th>
                    <th scope="col">Options</th>
                </tr>
            </thead>
            <tbody>
                @for (r of currentUser()?.data; track $index) {
                <tr [attr.data-flight-id]="r.flightId">
                    <th scope="row">{{getFlight(r)?.flightNumber}}</th>
                    <td>{{getFlight(r)?.destination}}</td>
                    <td class="hidden-3">{{utils.formatDate(getFlight(r)!.scheduledAt)}}</td>
                    <td class="hidden-4">{{r.airline}}</td>
                    <td class="hidden-2">{{r.suite}}</td>
                    <td>{{r.status}}</td>
                    <td class="hidden-1">{{utils.formatDate(r.updatedAt ?? r.createdAt)}}</td>
                    <td>
                        <div class="btn-group">
                            @if (r.status == 'waiting') {
                            <button type="button" class="btn btn-sm btn-primary" (click)="pay(r)">
                                <i class="fa-solid fa-credit-card"></i> Pay
                            </button>
                            <button type="button" class="btn btn-sm btn-danger" (click)="cancel(r)">
                                <i class="fa-solid fa-ban"></i> Cancel
                            </button>
                            } @else if (r.status == 'paid') {
                            <button type="button" class="btn btn-sm btn-success" (click)="like(r)">
                                <i class="fa-solid fa-thumbs-up"></i> Like
                            </button>
                            <button type="button" class="btn btn-sm btn-danger" (click)="dislike(r)">
                                <i class="fa-solid fa-thumbs-down"></i> Dislike
                            </button>
                            } @else {
                            /
                            }
                        </div>
                    </td>
                </tr>
                }
            </tbody>
        </table>
        } @else {
        <p class="text-center fw-bold">
            You haven't made any reservations yet!
        </p>
        }
    </div>
</div>